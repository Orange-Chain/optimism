version: "3.4"

x-var: &L1_NODE_WEB3_URL
  L1_NODE_WEB3_URL=https://rinkeby.omgx.network #please correct

#anything will do, as long as it has ETH in it, I think
x-var: &FRAUD_PROVER_WALLET_PRIV_KEY
  L1_WALLET_KEY=

#if things are set up correctly, the .sh script will fill this in for you
x-var: &ADDRESS_MANAGER_ADDRESS
  ADDRESS_MANAGER_ADDRESS=

x-var: &ROLLUP_CLIENT_HTTP
  ROLLUP_CLIENT_HTTP=http://data_transport_layer:7878

x-var: &ROLLUP_STATE_DUMP_PATH
  ROLLUP_STATE_DUMP_PATH=http://deployer:8080/state-dump.latest.json

x-var: &DEPLOYER_HTTP
  DEPLOYER_HTTP=http://deployer:8080

services:
  verifier:
    environment:
      - ROLLUP_VERIFIER_ENABLE=true
      - *DEPLOYER_HTTP
      - *L1_NODE_WEB3_URL
      - *ROLLUP_CLIENT_HTTP
      - *ROLLUP_STATE_DUMP_PATH
      - ETH1_SYNC_SERVICE_ENABLE=true
      - ETH1_CTC_DEPLOYMENT_HEIGHT=8
      - ETH1_CONFIRMATION_DEPTH=0
      - ROLLUP_POLL_INTERVAL_FLAG=3s
      - USING_OVM=true
      - CHAIN_ID=28
      - NETWORK_ID=28
      - DEV=true
      - DATADIR=/root/.ethereum
      - RPC_ENABLE=true
      - RPC_ADDR=verifier
      - RPC_CORS_DOMAIN=*
      - RPC_VHOSTS=*
      - RPC_PORT=8045
      - WS=true
      - WS_ADDR=0.0.0.0
      - IPC_DISABLE=true
      - TARGET_GAS_LIMIT=9000000
      - RPC_API=eth,net,rollup,web3
      - WS_API=eth,net,rollup,web3
      - WS_ORIGINS=*
      - GASPRICE=0
      - NO_USB=true
      - GCMODE=archive
      - NO_DISCOVER=true
      - RETRIES=60

  fraud_prover:
    environment:
      - *L1_NODE_WEB3_URL
      - *FRAUD_PROVER_WALLET_PRIV_KEY
      - *ADDRESS_MANAGER_ADDRESS
      - L2_NODE_WEB3_URL=http://verifier:8045
      - NO_TIMEOUT=true
      - POLLING_INTERVAL=5000
      - RUN_GAS_LIMIT=8999999
      - RELAY_GAS_LIMIT=8999999
      - FROM_L2_TRANSACTION_INDEX=0
      - L2_BLOCK_OFFSET=1
      - L1_START_OFFSET=8
      - RETRIES=60
